---
title: "Suppl_2"
author: "Michael Soutschek"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: html_document
---


```{r, include=FALSE}
if(!exists('FIG_NB')){
  FIG_NB <- 0; FIG_STRING <- "Supplementary Figure S"
  getFigNb <- function(increment=FALSE){
    if(increment) FIG_NB <<- FIG_NB + 1
    paste0(FIG_STRING,FIG_NB)
  }
}
knitr::opts_chunk$set(fig.width=8)
```

# `r getFigNb(TRUE)`



```{r, include=FALSE}
suppressPackageStartupMessages({
  library(ggplot2)
  library(cowplot)
})
source("../../misc.R")
```


```{r, include=FALSE}
df_a <- readRDS("../../../Add_Datasets/Amin/plot_df.rds")
df_a$name <- "miR-218 ko (Amin et al., 2015)"

# df_l <- readRDS("../../../Add_Datasets/Loeb/plot_df.rds")
# df_l$name <- "miR-155 ko (Loeb et al., 2012)"

df_e <- readRDS("../../../Add_Datasets/Eichhorn/plot_df.rds")
df_e$name <- "miR-122 ko (Eichhorn et al., 2014)"

df5 <- rbind(df_a,df_e)
df5$tool[which(df5$tool == "TS")] <- "Targetscan" 

p5 <- ggplot(df5, aes(x=log_ag, y=r2, color=tool)) +
  geom_line(size=1.2) +
  theme_minimal() + 
  scale_color_manual(values = meth_cols2) +
  geom_vline(xintercept = -4.863126, linetype = "dashed", color = "grey42") + 
  labs(x="log(a)", y=expression(~"Variance explained "*(r^2)), color="Method") +
  theme(
                panel.border =element_rect(color="black", fill=NA),
                text = element_text(size=12),
                legend.title = element_text(size = rel(0.9)),
                legend.text = element_text(size = rel(0.8))
  ) + facet_wrap("name",ncol = 2)
```

```{r, fig.width=8, fig.height=4}
p5
```


### `r getFigNb()`

**ScanMiR repression predictions outperform Targetscan predictions in different mouse miRNA knockout datasets.** Plots displaying the variance explained ($r^2$) of scanMiR and Targetscan repression predictions with mRNA logFC obtained by RNA-sequencing upon knockout of miR-122 (Eichhorn et al., 2014) or miR-218 (Amin et al., 2015). The globally optimized ln(a)-value used by default in scanMiR is indicated with a dashed grey line.
